<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="styles.css" />
    <link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
  crossorigin="anonymous"
/>
    <title>Document</title>
  </head>
  <body>
    <button class="icon icon-rotate surprise-button">
        <i class="fas fa-envelope"></i>
      </button>
      
    <div class="avatar-section">
      <div class="hair">
        <div id="hair-blob-1" class="blob" style="--i: 0"></div>
        <div id="hair-blob-2" class="blob" style="--i: 1"></div>
        <div id="hair-blob-3" class="blob" style="--i: 2"></div>
        <div id="hair-blob-4" class="blob" style="--i: 3"></div>
        <div id="hair-blob-5" class="blob" style="--i: 4"></div>
        <div id="hair-blob-6" class="blob" style="--i: 5"></div>
        <div id="hair-blob-7" class="blob" style="--i: 6"></div>
        <div id="hair-blob-8" class="blob" style="--i: 7"></div>
        <div id="hair-blob-9" class="blob" style="--i: 8"></div>
        <div id="hair-blob-10" class="blob" style="--i: 9"></div>
        <div id="hair-blob-11" class="blob" style="--i: 10"></div>
        <div id="hair-blob-12" class="blob" style="--i: 11"></div>
        <div id="hair-blob-13" class="blob" style="--i: 12"></div>
        <div id="hair-blob-14" class="blob" style="--i: 13"></div>
        <div id="hair-blob-15" class="blob" style="--i: 14"></div>
        <div id="hair-blob-16" class="blob" style="--i: 15"></div>
        <div id="hair-blob-17" class="blob" style="--i: 16"></div>
        <div id="hair-blob-18" class="blob" style="--i: 17"></div>
        <div id="hair-blob-19" class="blob" style="--i: 18"></div>
        <div id="hair-blob-20" class="blob" style="--i: 19"></div>
        <div id="hair-blob-21" class="blob" style="--i: 20"></div>
      </div>

      <div class="face">
        <div class="eye-glass">
          <div class="eye-glass-left"></div>
          <div class="rim"></div>
          <div class="eye-glass-right"></div>
        </div>
        <div class="eyelid-left">
          <div class="eye eye-left"></div>
        </div>
        <div class="eyelid-right">
          <div class="eye eye-right"></div>
        </div>
        <div class="mouth"></div>
      </div>
    </div>
  </body>
</html>
<script>
  (function () {
    const glasses = document.querySelector(".eye-glass");
    const eyes = document.querySelectorAll(".eye");
    const eyelids = document.querySelectorAll(".eyelid-left, .eyelid-right");
    const mouth = document.querySelector(".mouth");
    const face = document.querySelector(".face");
    const hairBlobs = document.querySelectorAll(".blob");
    let last = { x: 0, y: 0, t: Date.now() };

    // Precompute each eye’s max horizontal offset
    const eyeMaxOffsets = Array.from(eyes).map((eye, i) => {
      const lid = eyelids[i];
      const lidRect = lid.getBoundingClientRect();
      const eyeRect = eye.getBoundingClientRect();
      return (lidRect.width - eyeRect.width) / 2;
    });

    //       function triggerHairJiggle() {
    //   hairBlobs.forEach(blob => {
    //     const amp  = 2 + Math.random() * 3;    // between 2° and 5°
    //     const dur  = 0.3 + Math.random() * 0.4; // between 0.3s and 0.7s
    //     const name = `jiggle-${amp.toFixed(1)}`;

    //     // dynamically create a keyframe for this amplitude
    //     const rule = `
    //       @keyframes ${name} {
    //         0%   { transform: none; }
    //         25%  { transform: translate(${amp}px, -${amp}px) rotate(-${amp}deg); }
    //         50%  { transform: translate(-${amp}px, ${amp}px) rotate(${amp}deg); }
    //         75%  { transform: translate(${amp}px, ${amp}px) rotate(-${amp/2}deg); }
    //         100% { transform: none; }
    //       }
    //     `;

    //     // remove any old style tag, insert new one
    //     let style = blob._jiggleStyle;
    //     if (style) style.remove();
    //     style = document.createElement('style');
    //     style.textContent = rule;
    //     document.head.append(style);
    //     blob._jiggleStyle = style;

    //     // trigger it
    //     blob.style.animation = 'none';
    //     blob.offsetWidth;
    //     blob.style.animation = `${name} ${dur}s ease-in-out`;
    //   });
    // }

    window.addEventListener("mousemove", (e) => {
      const now = Date.now();
      const dt = now - last.t || 16;
      const dx = e.clientX - last.x;
      const dy = e.clientY - last.y;
      const speed = Math.hypot(dx, dy) / dt;
      // if (speed > 0.5) triggerHairJiggle();
      last = { x: e.clientX, y: e.clientY, t: now };

      // normalize to [-1,1]
      const cx = window.innerWidth / 2;
      const cy = window.innerHeight / 2;
      const rx = (e.clientX - cx) / cx;
      const ry = (e.clientY - cy) / cy;

      // subtle face movement (opposite direction)
      const faceX = -rx * 4; // px
      const faceY = -ry * 3; // px
      face.style.transform = `translate(${faceX}px, ${faceY}px)`;

      // glasses
      glasses.style.transform = `translate(${-rx * 10}px, ${-ry * 6}px)`;

      // eyes (full horizontal travel)
      eyes.forEach((eye, i) => {
        eye.style.transform = `translateX(${-rx * eyeMaxOffsets[i]}px)`;
      });

      // mouth (full-range nudge)
      mouth.style.transform = `translate(${-rx * 10}px, ${-ry * 4}px)`;
    });
  })();
</script>
